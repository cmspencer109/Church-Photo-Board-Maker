{% extends "photomaker/base.html" %}
{% load static %}
{% block content %}

<div class="container">
  <div class="row mt-5">
    <div class="col-md-4">

      <div class="mb-3">
        <label for="familyNameInput" class="form-label">Family Name</label>
        <input type="text" class="form-control" id="familyNameInput" placeholder="Luther">
      </div>
  
      <div class="mb-3">
        <label for="parentsInput" class="form-label">Parents</label>
        <input type="text" class="form-control" id="parentsInput" placeholder="Martin & Katie">
      </div>
  
      <div class="mb-3">
        <label for="childrenInput" class="form-label">Children</label>
        <input type="text" class="form-control" id="childrenInput" placeholder="Hans, Elizabeth, Magdalene, Martin, Paul, Margaret">
      </div>

      <!-- <form action="" method="POST" enctype="multipart/form-data">
        {% csrf_token %}
        {{ form.as_p }}
        <button type="submit" class="btn btn-primary">Upload</button>
      </form> -->

      <!-- <br> -->
      <button type="submit" class="btn btn-primary" onclick="downloadMemberPhoto()">Download</button>
      
    </div>
    <div class="col-md-8">
      
      <div id="photo-template" class="mx-auto">
        <div class="safe-area">
          <div class="photo-area">

          </div>
          <div class="text-area">
            <div class="family-name">Knickelbein</div>
            <div class="text-spacer">&nbsp;</div>
            <div class="parents">Mark & Sara</div>
            <div class="text-spacer">&nbsp;</div>
            <div class="children">
              Simeon<br>
              Henry<br>
              Walter<br>
              Theodore
            </div>
          </div>
        </div>
      </div>
      
    </div>
  </div>
</div>

<script type="text/javascript">
$(document).ready(function() {
  // Family Name field live update
  $('#familyNameInput').on('input', function() {
    var familyName = $(this).val();
    $('.family-name').text(familyName);
  });

  // Parents field live update
  $('#parentsInput').on('input', function() {
    var parents = $(this).val();
    $('.parents').text(parents);
  });

  // Children field live update
  $('#childrenInput').on('input', function() {
    var children = $(this).val();
    $('.children').text(children);
  });
});

function downloadMemberPhoto() {
  htmlToImage.toJpeg(document.getElementById('photo-template'), { quality: 1 })
  .then(function (dataUrl) {
    var link = document.createElement('a');
    link.download = 'member-photo.jpg';
    link.href = dataUrl;
    link.click();
  });
}
</script>

{% endblock content %}
